<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>한이음 아이템 여행 다이어리</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <!--external css-->
    <link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link href="assets/js/fullcalendar/bootstrap-fullcalendar.css" rel="stylesheet" />
        
    <!-- Custom styles for this template -->
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/style-responsive.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

  <section id="container" >
      <!-- **********************************************************************************************************************************************************
      TOP BAR CONTENT & NOTIFICATIONS
      *********************************************************************************************************************************************************** -->
      <!--header start-->
      <header class="header black-bg">
               <div class="sidebar-toggle-box">
                  <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
              </div>
            <!--logo start-->
            <a href="index.html" class="logo"><b>Itrip</b></a>
            <!--logo end-->
            <div class="top-menu">
              <ul class="nav pull-right top-menu">
                    <li><a class="logout" href="login.html">Logout</a></li>&emsp;
              </ul>
            </div>
            <div class="nav notify-row" id="top_menu">
                <ul class="nav top-menu">

                  <a href="#"><i class="fa fa-file-image-o fa-lg"></i></a>
                  &emsp;
                  <a href="#"><i class="fa fa-search fa-lg"></i></a>  
                  &emsp;
                  <a href="#"><i class="fa fa-info-circle fa-lg"></i></a>
                  &emsp;
            </div>
        </header>
      <!--header end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN SIDEBAR MENU
      *********************************************************************************************************************************************************** -->
      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu" id="nav-accordion">
                  <a href="#"><i class="fa fa-asterisk" aria-hidden="true"></i></a>
                  </br>
                  <p class="centered"><a href="profile.html"><img src="assets/img/ui-sam.jpg" class="img-circle" width="60"></a></p>
                  <h5 class="centered">스타트립</h5>
                    

                  <li class="sub-menu">
                      <a href="javascript:;" >
                      <span>여행1</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="#">여행스케쥴</a></li>
                          <li><a  href="gallery.html">앨범</a></li>
                          <li><a  href="#">가계부</a></li>
                      </ul>
                  </li>
              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>
      <!--sidebar end-->






































<!-- **********************************************************************************************************************************************************
MAIN CONTENT
*********************************************************************************************************************************************************** -->
<!--main content start-->
<section id="main-content">
    <section class="wrapper" style="padding:3em">
		 <!-- page start-->
        <h3><i class="fa fa-angle-right"></i> 계획 작성하기</h3>
		<div id="complete_btn" style="float:right;">
			<button type="button" class="btn btn-success" value="완료하기" onclick="complete_event();"> 완료하기 </button>
			<button type="button" class="btn btn-theme" value="취소하기" onclick="cancle_event();"> 취소하기 </button>
		</div>
		
		<div id="locationField">
				<input id="autocomplete" class="form-control" type="text">
		</div>

		<div id="map_canvas"></div>
    <div class="row mt">
		

        <aside class="col-lg-9 mt">
            <section class="panel">
				<h5>* 달력 다이어리</h5>
                <div class="panel-body">
                    <div id="calendar" class="has-toolbar"></div>
       			</div>
            </section>
        </aside>

		<aside class="col-lg-3 mt">
						<h4><i class="fa fa-angle-right"></i> 선택 장소</h4>
							<div id="external-events">
									<!-- <div class="external-event label label-theme">My Event 1</div>
									<div class="external-event label label-success">My Event 2</div>
									<div class="external-event label label-info">My Event 3</div>
									<div class="external-event label label-warning">My Event 4</div>
									<div class="external-event label label-danger">My Event 5</div>
									<div class="external-event label label-default">My Event 6</div>
									<div class="external-event label label-theme">My Event 7</div>
									<div class="external-event label label-info">My Event 8</div>
									<div class="external-event label label-success">My Event 9</div> -->
							</div>
							<p class="drop-after">
								<input type="checkbox" id="drop-remove">
									체크 후 드래그 시 장소가 삭제됩니다.
							</p>
		</aside>
    </div>

	

	

	

    <!-- page end-->
	</section> <!-- /wrapper -->
</section><!-- /MAIN CONTENT -->

























      <!--main content end-->
      <!--footer start-->
      <footer class="site-footer">
          <div class="text-center">
              Itrip
              <a href="editScheduler.html" class="go-top">
                  <i class="fa fa-angle-up"></i>
              </a>
          </div>
      </footer>
      <!--footer end-->
  </section>













    <!-- js placed at the end of the document so the pages load faster -->
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/fullcalendar/fullcalendar.min.js"></script>    
    <script src="assets/js/jquery-ui-1.9.2.custom.min.js"></script>
    <script src="assets/js/jquery.ui.touch-punch.min.js"></script>
    <script class="include" type="text/javascript" src="assets/js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="assets/js/jquery.scrollTo.min.js"></script>
    <script src="assets/js/jquery.nicescroll.js" type="text/javascript"></script>

    <!--common script for all pages-->
    <script src="assets/js/common-scripts.js"></script>

    <!--script for this page-->
	<script src="assets/js/calendar-conf-events.js"></script>    

	<!-- 맵연동하는 코드 -->
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>


	<!--맵 관련 사항 -->
	<script type="text/javascript">

		var map, places, iw;
		var markers = [];	//마커 정보 모음
		var autocomplete;
		var tempPlace;
		

		function initialize() {
			var myLatlng = new google.maps.LatLng(37.566535, 126.97796919999996);	//초기 맵의 포커스를 위해 초기 설정
			
			var myOptions = {
				zoom: 14,
				center: myLatlng,
				mapTypeId: google.maps.MapTypeId.ROADMAP
			};
			//초기 맵 설정

			map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);
			places = new google.maps.places.PlacesService(map);
			google.maps.event.addListener(map, 'tilesloaded', tilesLoaded);    // 지도에 해당 마커를 표시하는 리스터 정의 부분
			
			autocomplete = new google.maps.places.Autocomplete(document.getElementById('autocomplete'));	//이 부분이 텍스트에딧부분 설정 코드
			google.maps.event.addListener(autocomplete, 'place_changed', function () {
				showSelectedPlace();
			});
		}

		//텍스트 자동 검색
		function tilesLoaded() {
			//지도 해당 마커를 표시하는 부분
			//호출 search
			google.maps.event.clearListeners(map, 'tilesloaded');
			//google.maps.event.addListener(map, 'zoom_changed', search);
			//google.maps.event.addListener(map, 'dragend', search);
			//search();
		}

		//지도 장소 설정 부분
		function showSelectedPlace() {
			clearMarkers();

			//이부분이 로케이션 받는 부분
			var place = autocomplete.getPlace();
			//alert(place.geometry.location);

			map.panTo(place.geometry.location);
			markers[0] = new google.maps.Marker({
				position: place.geometry.location,
				map: map
			});
			/*iw = new google.maps.InfoWindow({
				content: getIWContent(place)
			});
			iw.open(map, markers[0]);*/

			google.maps.event.addListener(markers[0], 'click', getDetails(place, 0)); 

		}

		//마커 자동 추가부분
		/*function search() {
			//이부분은 네비게이션 텍스트 에딧의 자동 찾기 시스템 부분
			autocomplete.setBounds(map.getBounds());
			var search = {
				bounds: map.getBounds()
			};

			places.search(search, function (results, status) {
				if (status == google.maps.places.PlacesServiceStatus.OK) {
					clearMarkers();
					for (var i = 0; i < results.length; i++) {
						markers[i] = new google.maps.Marker({
							position: results[i].geometry.location,
							animation: google.maps.Animation.DROP
						});

						//result = place
						google.maps.event.addListener(markers[i], 'click', getDetails(results[i], i)); 

						setTimeout(dropMarker(i), i * 100);
						
					}
				}
			});
		}*/

		//맵 마커 클리어
		function clearMarkers() {
			for (var i = 0; i < markers.length; i++) {
				if (markers[i]) {
					markers[i].setMap(null);
					markers[i] == null;
				}
			}
		}

		//맵 마커 표시
		function dropMarker(i) {
			return function () {
				markers[i].setMap(map);
			}
		}

		function getDetails(result, i) {
			return function () {
				//이 부분은 마커 클릭 시에 세부정보로 넘어가는 기능을 하는부분
				//이부분을 추후 장소 div를 추가하는 부분으로 한다.

				places.getDetails({
					reference: result.reference
				}, showInfoWindow(i));
			}
		}

		function showInfoWindow(i) {
			//마커를 띄우는 부분
			return function (place, status) {
				if (iw) {
					iw.close();
					iw = null;
				}
				if (status == google.maps.places.PlacesServiceStatus.OK) {
					iw = new google.maps.InfoWindow({
						content: getIWContent(place),
					});
					tempPlace =place;

					iw.open(map, markers[i]);
				}
			}
		}

		function button_event(){
			if (confirm("추가하시겠습니까?") == true){    //확인
				Add_Type_BTN();
			}else{   //취소
				return;
			}
			
		}

		function complete_event(){
			if (confirm("스케줄러를 저장합니다.") == true){    //확인
				Add_Type_BTN();
			}else{   //취소
				return;
			}
			
		}

		function cancle_event(){
			if (confirm("스케줄러 작성을 취소합니다.") == true){    //확인
				location.href="showScheduler.html";
			}else{   //취소
				return;
			}
			
		}

		function Add_Type_BTN(){
			//document.getElementById('external-events').innerHTML='<div class="external-event label label-info">' + tempPlace.name + '</div>';
			
			var div =document.createElement('div');
			div.className = "external-event label label-info";

			document.getElementById('external-events').appendChild(div).innerHTML = tempPlace.name;

			$('#external-events div.external-event').each(function() {

				// create an Event Object (http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)
				// it doesn't need to have a start or end
				var eventObject = {
					title: $.trim($(this).text()) // use the element's text as the event title
				};

				// store the Event Object in the DOM element so we can get to it later
				$(this).data('eventObject', eventObject);

				// make the event draggable using jQuery UI
				$(this).draggable({
					zIndex: 999,
					revert: true,      // will cause the event to go back to its
					revertDuration: 0  //  original position after the drag
				}
			
			);

    	});

		}

		function getIWContent(place) {
			//이부분이 클릭 이벤트가 들어가는 부분이다.!!
			var content = '<table style="border:0"><tr><td style="border:0;">';
			content += '<img class="placeIcon" src="' + place.icon + '"></td>';
			content += '<td style="border:0;"><b>'+place.name+'</b>';
			content += '</td></tr></table>';
			content += '<input type="button" value="추가하기" onclick="button_event();">';
			return content;
		}

		/*
		<a href="' + place.url + '">' + place.name + " 추가" + '</a>
		*/

		/*$('.external-events').on('click', '#external-event', function(e) {
			alert('123');
    	});*/

		//해당 완료 시 맵을 로드한다.
		google.maps.event.addDomListener(window, 'load', initialize);

	</script>



    <style type="text/css">
		#map_canvas {
			float: left;
			width: 820px;
			height: 406px;
		}
		.placeIcon {
			width: 16px;
			height: 16px;
			margin: 2px;
		}
		#results {
			border-collapse: collapse;
			width: 184px;
		}
		#locationField {
			margin-left: 1px;
		}
		#autocomplete {
			width: 516px;
			border: 1px solid #ccc;
		}
	</style>

    <style type="text/css">   
        #map_canvas { } 
    </style> 

  </body>
</html>
